<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Standard Meta -->
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

    <!-- Site Properties -->
    <title>admin - Spider</title>


    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/reset.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/site.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/container.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/grid.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/header.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/image.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/menu.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/divider.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/segment.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/form.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/input.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/button.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/list.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/message.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/icon.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/dropdown.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/sidebar.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/transition.min.css}"/>





    <link rel="stylesheet" type="text/css" th:href="@{/semantic/components/table.min.css}"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script th:src="@{/trumbowyg/trumbowyg.min.js}" ></script>
    <link rel="stylesheet" th:href="@{/trumbowyg/ui/trumbowyg.min.css}" />



    <script th:src="@{/semantic/components/form.min.js}"></script>
    <script th:src="@{/semantic/components/transition.min.js}"></script>
    <script th:src="@{/semantic/components/visibility.min.js}"></script>
    <script th:src="@{/semantic/components/sidebar.min.js}"></script>

    <link rel="stylesheet" type="text/css" th:href="@{/css/main.css}"/>
    <script th:src="@{/main.js}"></script>

    <script src="https://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"></script>
    <script type="text/javascript">
		var ws = null;
		function setConnected(connected) {
			document.getElementById('connect').disabled = connected;
			document.getElementById('disconnect').disabled = !connected;
			document.getElementById('echo').disabled = !connected;
			document.getElementById('register').disabled = !connected;

		}
		function connect() {
			ws = new SockJS("/spider_tasks");
			ws.onopen = function () {
				setConnected(true);
				log('Info: WebSocket connection opened.');
			};
			ws.onmessage = function (event) {
				log('Received: ' + event.data);
			};
			ws.onclose = function () {
				setConnected(false);
				log('Info: WebSocket connection closed.');
			};
		}
		function disconnect() {
			if (ws != null) {
				ws.close();
				ws = null;
			}
			setConnected(false);
		}
		function echo() {
			if (ws != null) {
				var message = document.getElementById('message').value;
				log('Sent: ' + message);
				ws.send(message);
			} else {
				alert('WebSocket connection not established, please connect.');
			}
		}

        function registerMsg() {
			if (ws != null) {
				var message = "register_burimi_id=" + document.getElementById('burimi_id').value;
				log('Registered for burimi: ' + message);
				ws.send(message);
			} else {
				alert('WebSocket connection not established, please connect.');
			}
		}

		function log(message) {
			var console = document.getElementById('console');
			var p = document.createElement('p');
			p.style.wordWrap = 'break-word';
			p.appendChild(document.createTextNode(message));
			console.appendChild(p);
			while (console.childNodes.length > 25) {
				console.removeChild(console.firstChild);
			}
			console.scrollTop = console.scrollHeight;
		}
	</script>


</head>
<body>

<noscript><h2 style="color: #ff0000">Seems your browser doesn't support Javascript! Websockets rely on Javascript being enabled. Please enable
    Javascript and reload this page!</h2>
</noscript>

    <div th:replace="admin/fragments/header :: header('burime')"> </div>

    <div class="bosh">
    </div>

    <div class="ui container" th:object="${editBurim}">

        <h2 class="ui dividing header">Spider per <th:block th:utext="${editBurim.title}"/> <a class="anchor" id="types"></a></h2>


        <input type="hidden" id="burimi_id" th:value="${editBurim.id}"/>
        <p> Ketu mund te monitoroni spider per kete burim, ai mund te jete ne gjendje running, ose gati per tu nisur. Nje here qe spider ka nisur ai mund te zgjase shume kohe, nderkohe ju mund te
            vini ne kete faqe me vone dhe spider nuk do te nderpritet. Nese i bheni stop spiderit, ai do te humbase tere te dhenat e deriatyshme, dhe nuk do te mund te beje me resume.
            <br/> Ky spider do kerkoje ne faqen: <th:block th:utext="${editBurim.url_burimi}"/> dhe do kerkoje per cdo file mp3 ne ate faqe dhe nen domainin:
            <th:block th:utext="${editBurim.mp3_domain}"/>
        </p>

        <hr/>

        <div class="ui active progress">
            <div class="bar">
                <div class="progress"></div>
            </div>
            <div class="label">Spider is running</div>
        </div>


        <div>
            <div id="connect-container">
                <div>
                    <button id="connect" onclick="connect();">Connect</button>
                    <button id="disconnect" disabled="disabled" onclick="disconnect();">Disconnect</button>
                </div>
                <div>
                    <textarea id="message" style="width: 350px">start</textarea>
                </div>
                <div>
                    <button id="echo" onclick="echo();" disabled="disabled">Send message</button>
                    <button id="register" onclick="registerMsg();" disabled="disabled">Register</button>
                </div>
            </div>

            </div>

<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>


        <div class="ui stackable equal width grid">
            <div class="column">
                <div id="console"></div>
            </div>
            <div class="column">
                <div id="console_mp3"></div>
            </div>
        </div>



        <hr/>



            <div class="ui buttons center">
                <button class="ui button" href="/admin/burime">Anullo</button>
                <div class="or"></div>
                <button class="ui positive button submit">Start Spider</button>
            </div>


    </div>

    <div th:replace="admin/fragments/footer :: footer"> </div>


</body>

</html>



